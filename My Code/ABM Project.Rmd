---
title: "ABM Project"
author: "Bernard A. Coles IV"
date: "9/10/2019"
output: pdf_document
---

```{r Library, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
library(network)
library(RSiena)
library(devtools)
library(sna)
```

```{r Loading Data, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}
t1 <- as.matrix(read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/t1.dat", header = F, sep = " "))

t2 <- as.matrix(read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/t2.dat", header = F, sep = " "))

t3 <- as.matrix(read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/t3.dat", header = F, sep = " "))

t4 <- as.matrix(read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/t4.dat", header = F, sep = " "))

cov1 <- read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/cov1.dat", header = F, sep = " ", na.strings = "NA")

cov4 <- read.delim("~/desktop/Repository/Agent-Based-Models/Data/Marijtje-Signed-Longitudinal/cov4.dat", header = F, sep = " ")

#Network Objects
t1.net <- as.network(t1)
t2.net <- as.network(t2)
t3.net <- as.network(t3)
t4.net <- as.network(t4)

summary(t1.net)
summary(t2.net)
summary(t3.net)
summary(t4.net)

```

```{r Cleaning, message=FALSE, warning=FALSE, include=FALSE, paged.print=FALSE}

```

```{r Visualize, echo=FALSE, message=FALSE, warning=FALSE, paged.print=FALSE}
op <- par(mfrow=c(2,2), mai = c(0,0,0.7,0))
set.seed(88)
gplot(t1.net, edge.col = "azure3", vertex.col="red3",label = seq(1,38), vertex.cex=1.5, label.pos = 5, label.cex=0.5)
title("Sentiment Network (t1)")


gplot(t2.net, edge.col = "azure3", vertex.col="lightblue",label = seq(1,38), vertex.cex=1.5, label.pos = 5, label.cex=0.5)
title("Advice Network (t2)")

gplot(t3.net, edge.col = "azure3", vertex.col="lavender",label = seq(1,38), vertex.cex=1.5, label.pos = 5, label.cex=0.5)
title("Advice Network (t3)")

gplot(t4.net, edge.col = "azure3", vertex.col="darkgreen",label = seq(1,38), vertex.cex=1.5, label.pos = 5, label.cex=0.5)
title("Advice Network (t3)")
par(op)
```

```{r Sienna Model}
nets <- array(c(t1.net, t2.net, t3.net, t4.net), dim = c(38, 38, 4))
sentiment <- sienaDependent(nets, sparse = T) #Think it wont run because there are numbers other than 0 and 1 in the matrices.. Need creative solution
sentiment.data <- sienaDataCreate(sentiment)
```

